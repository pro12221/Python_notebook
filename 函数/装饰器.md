## 装饰器
在不修改被装饰源代码以及调用方法前提下，为被装饰者加上新功能
```python
# 需求：在不修改index函数体代码以及调用方式的前提下，为index函数添加上统计运行时间的功能
import time
# 实现一
def index():
    print("hello")
def wapper():
    start = time.time()
    index()
    stop = time.time()
    print("run time is %s" % (stop - start))

# 实现二    
def wapper(func):
    start = time.time()
    func()
    stop = time.time()
    print("run time is %s" % (stop - start))

def foo(func):
    def wapper(*args,**kwargs):
            start = time.time()
            func()
            stop = time.time()
            print("run time is %s" % (stop - start))
    return wapper
index=foo(index)
index()

```
## 装饰器的语法糖
```python

def foo(func):
    def wapper(*args,**kwargs):
            start = time.time()
            func()
            stop = time.time()
            print("run time is %s" % (stop - start))
    return wapper

@foo # index= foo(index)
def index():
    print("hello")

index()
```

## Wraps装饰器
```python
def foo(func):
    @wraps(func)
    def wapper(*args,**kwargs):
            start = time.time()
            func()
            stop = time.time()
            print("run time is %s" % (stop - start))
    return wapper

@foo # index= foo(index)
def index():
    print("hello")

index()
```
## 叠加多个装饰器
```python
def deco1(func1):  # func1 = wrapper2的内存地址
    print("deco1...")

    def wrapper1(*args, **kwargs):
        print('wrapper1...')
        res1 = func1(*args, **kwargs)
        return res1

    return wrapper1


def deco2(func2):  # func2 = wrapper3的内存地址
    print("deco2...")

    def wrapper2(*args, **kwargs):
        print('wrapper2...')
        res2 = func2(*args, **kwargs)
        return res2

    return wrapper2


def deco3(func3):  # func3 = 最原始的index函数的内存地址
    print("deco3...")

    def wrapper3(*args, **kwargs):
        print('wrapper3...')
        res3 = func3(*args, **kwargs)
        return res3

    return wrapper3


# 叠加多个装饰器：
# 装饰器的加载顺序，也就是装饰外层函数的调用顺序，是自下而上的
# 装饰器的执行顺序：即最内函数也就wrapper的执行顺序，是自上而下的，index -> wrapper1 -> wrapper2 -> wrapper3
# 补充:  加载阶段是执行外层函数的阶段，执行阶段是执行内层函数的阶段

# index = wrapper1的内存地址
@deco1  # deco1(wrapper2的内存地址)         -> wrapper1的内存地址
@deco2  # deco2(wrapper3的内存地址)         -> wrapper2的内存地址
@deco3  # deco3(最原始的index函数的内存地址) -> wrapper3的内存地址
def index():
    print('from index')
    return 123

# print(index)
res = index()  # wrapper1()
print(res)
"""
输出结果：
deco3..
deco2...
deco1...
wrapper1...
wrapper2...
wrapper3...
"""

```

## 有参装饰器
```python

def file(engine):
    def auth(func):
        def wapper(*args,**kwargs):
            username=input("input username").strip()
            password=input("input pw").strip()
            if engine=="mysql":
                if username=="wsa" and password=="123":
                    res=func()
                    return res
                else:
                    print("error")
            else:
                print("error")

        return wapper
    return auth


@file('mysql') # index=auth的内存地址(index)
def index():
    print("from index")

print(index)
```